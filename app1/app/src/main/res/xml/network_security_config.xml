<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <!-- 允许HTTP和HTTPS，方便用户使用各种反代服务器 -->
    <!-- ⚠️ 注意：用户应该了解HTTP传输的安全风险 -->
    <base-config cleartextTrafficPermitted="true">
        <trust-anchors>
            <certificates src="system"/>
            <certificates src="user"/> <!-- 支持用户安装的证书，方便企业内网使用 -->
        </trust-anchors>
    </base-config>
    
    <!-- 证书固定配置 - 针对官方后端API -->
    <!--
        ✅ 最佳实践：只 pin 中间证书和根证书，不 pin 叶子证书
        这样即使服务器证书更新（Let's Encrypt 每3个月更新），app 仍然可以正常工作
        只要继续使用相同的 CA（如 Google Trust Services），就不会有问题
    -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">ai.luuu71.dpdns.org</domain>
        <pin-set expiration="2027-12-31">
            <!--
                证书pin策略 - 2025-11-09更新
                
                ⚠️ 重要：我们只 pin CA证书，不 pin 服务器证书
                这样服务器证书更新时不需要更新 app
                
                当前使用的 CA: Google Trust Services (Let's Encrypt 的后端)
                - 中间证书: Google Trust Services WE1
                - 根证书: Google Trust Services Root
                
                这些证书有效期很长（10年+），极少变化
                
                如果需要更换 CA，需要：
                1. 提前在这里添加新 CA 的 pin
                2. 发布新版本 app
                3. 等待用户更新后再更换服务器证书
            -->
            
            <!-- ✅ Google Trust Services WE1 中间证书 (推荐) -->
            <pin digest="SHA-256">f0KW/FtqTjs108NpYj42SrGvOB2PpxIVM8nWxjPqJGE=</pin>
            
            <!-- ✅ Google Trust Services 根证书 (备用) -->
            <pin digest="SHA-256">hxqRlPTu1bMS/0DITB1SSu0vd4u/8l8TjPgfaAp63Gc=</pin>
            
        </pin-set>
        <trust-anchors>
            <certificates src="system"/>
        </trust-anchors>
    </domain-config>
</network-security-config>